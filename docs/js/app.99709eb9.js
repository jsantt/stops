(function(t){function e(e){for(var a,r,o=e[0],l=e[1],c=e[2],u=0,h=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&h.push(s[r][0]),s[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,o=1;o<i.length;o++){var l=i[o];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},s={app:0},n=[];function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var d=l;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"17dd":function(t,e,i){},"1dda":function(t,e,i){},"1e55":function(t,e,i){"use strict";var a=i("79d0"),s=i.n(a);s.a},2600:function(t,e,i){"use strict";var a=i("7f50"),s=i.n(a);s.a},"2d11":function(t,e,i){"use strict";var a=i("764e"),s=i.n(a);s.a},"3a40":function(t,e,i){},"3fea":function(t,e,i){},"46cd":function(t,e,i){"use strict";var a=i("3fea"),s=i.n(a);s.a},"51ad":function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);var a=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("Data",{ref:"data",attrs:{favoriteStops:t.favoriteStops},on:{"departure-data":t.departureDataReceived,"location-found":t.onLocationFound,"new-message":t.onNewMessage,"finding-location":function(e){return t.updateStatus("paikannetaan...")},"fetching-data":function(e){return t.updateStatus("haetaan...")}}}),i("Navigation",{ref:"navigation",staticClass:"navigation",on:{"time-switch-clicked":t.showRealtime,nearby:t.nearbyClicked,favorite:t.favoriteClicked}},[void 0!==t.message?i("Notification",{attrs:{texts:t.message},on:{"notification-button-clicked":t.allowLocationClicked}}):t._e()],1),i("div",{ref:"swipe",staticClass:"swipe"},[i("Nearest",{staticClass:"swipe-page",attrs:{filter:t.nearestFilter,favoriteStops:t.favoriteStops,lat:t.departureData.lan,lon:t.departureData.lon,realtime:t.realtime,departureData:t.departureData.nearest},on:{"departure-clicked":t.departureClicked,"toggle-favorite":t.toggleFavorite}},[i("Filter-lines",{attrs:{departureData:t.departureData.nearest,lat:t.departureData.lat,lon:t.departureData.lon},on:{"new-filter-value":t.filterNearest}})],1),i("Favorite",{staticClass:"swipe-page",attrs:{filter:t.favoriteFilter,favoriteStops:t.favoriteStops,lat:t.departureData.lan,lon:t.departureData.lon,realtime:t.realtime,departureData:t.departureData.favorite},on:{"toggle-favorite":t.toggleFavorite}})],1),void 0!==t.departureData.nearest&&t.departureData.nearest.length>0&&!1===t.favoriteTab?i("footer",[i("div",{staticClass:"footer-section"},[i("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 100 100"}},[i("circle",{attrs:{cx:"50",cy:"50",r:"30",stroke:"#d7fae1","stroke-width":"25",fill:"#94e0a9"}})]),t._v("\n      GPS signaaliin perustuva arvio merkitty tähdelle (*)\n    ")]),i("Install",{attrs:{forceShow:!0}})],1):t._e(),i("Text-resizer")],1)},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span")},o=[];function l(t,e,i,a){const s=6371,n=c(i-t),r=c(a-e),o=c(t),l=c(i),d=Math.sin(n/2)*Math.sin(n/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(o)*Math.cos(l),u=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),h=s*u;return h}function c(t){return t*Math.PI/180}function d(t){const e=Math.round(1e3*t);return e}async function u(t){const e=await t.json();return e.data.stops}function h(t,e,i){let a=[];return t.forEach(t=>{const s={...t};s.distance=d(l(e,i,t.lat,t.lon)),a.push(s)}),a}function v(t){const e=t.sort((t,e)=>t.distance>e.distance?1:-1);return e}async function f(t,e,i){const a=await window.fetch("https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:p(t)})});if(!a.ok)throw Error(a.statusText);const s=await u(a),n=h(s,e,i),r=v(n);return r}function p(t){const e=JSON.stringify(t);return`\n    {\n      stops(ids: ${e}) {\n        lat\n        lon\n        name\n        gtfsId\n        code\n        desc\n        locationType\n        vehicleType\n        stoptimesWithoutPatterns(numberOfDepartures:6,omitNonPickups:true, omitCanceled:true) {\n          scheduledDeparture\n          departureDelay\n          realtime\n          realtimeState\n          headsign\n          serviceDay\n          trip {\n            id\n            directionId\n            routeShortName\n            route {\n              mode\n            }\n          }\n        }\n      }\n    }`}async function g(t,e,i){const a=await t.json(),s=a.data.nearest.edges,n=[];return s.forEach(t=>{const a={...t.node.place};a.distance=d(l(e,i,t.node.place.lat,t.node.place.lon)),n.push(a)}),n}async function m(t){return t.sort((t,e)=>t.distance>e.distance?1:-1)}async function w(t,e,i){const a=await window.fetch("https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:y(t,e,i)})});if(!a.ok)throw Error(a.statusText);const s=await g(a,t,e),n=await m(s);return n}function y(t,e,i){const a=JSON.stringify(i);return`\n    {\n        nearest(lat: ${t}, lon: ${e}, maxResults: 20, maxDistance: 2000, filterByPlaceTypes: [STOP] ${void 0===i?"":`filterByIds:{stops: ${a}}`}) {\n          edges {\n            node {\n              distance\n              place {\n                id\n                lat\n                lon\n                ... on Stop {\n                  lat\n                  lon\n                  name\n                  gtfsId\n                  code\n                  desc\n                  locationType\n                  vehicleType\n                  stoptimesWithoutPatterns(numberOfDepartures:5,omitNonPickups:true, omitCanceled:true) {\n                    scheduledDeparture\n                    departureDelay\n                    realtime\n                    realtimeState\n                    headsign\n                    trip {\n                      id\n                      directionId\n                      routeShortName\n                       alerts {\n                        alertHeaderText\n                        alertDescriptionText\n                      }\n                      route {\n                        mode\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n    }`}var b={name:"Data",props:{favoriteStops:Array,fetchFavorites:Boolean},data:function(){return{pollingHandle:void 0,previousFetchTime:0,watchPositionHandle:void 0}},methods:{startPollingDefault(){const t={accuracy:null,lat:60.16704004097834,lon:24.946832000000086};window.localStorage.setItem("coordinates",JSON.stringify(t)),this.fetch(),this.pollingHandle=setInterval(this.fetch,15e3)},async startPolling(){clearInterval(this.pollingHandle),this.fetch(),this.pollingHandle=setInterval(this.fetch,15e3),document.removeEventListener("visibilitychange",this.visibilityChange),document.addEventListener("visibilitychange",this.visibilityChange),this.stopPositionWatching(),this.watchPosition()},visibilityChange(){"visible"===document.visibilityState&&this.fetch()},async fetch(){const t=JSON.parse(window.localStorage.getItem("coordinates"));this.$emit("fetching-data");try{const[e,i]=await Promise.all([w(t.lat,t.lon),f(this.favoriteStops,t.lat,t.lon)]),a={nearest:e,favorite:i,lat:t.lat,lon:t.lon};this.$emit("departure-data",a)}catch(e){const t={header:"Virhe haettaessa aikatauluja",body:"Kokeile uudestaan",button:"ok"};this.$emit("new-message",t)}},watchPosition(){this.$emit("finding-location"),this.$emit("new-message",{body:"Haetaan sijaintia"}),this.watchPositionHandle=navigator.geolocation.watchPosition(this.onLocationFound,this.onLocationError,{maximumAge:5e3,enableHighAccuracy:!0,timeout:8e3})},onLocationFound(t){this.$emit("location-found");const e={accuracy:t.coords.accuracy,lat:t.coords.latitude,lon:t.coords.longitude};window.localStorage.setItem("coordinates",JSON.stringify(e)),this.notifyIfInaccurateLocation(e),this.fetch()},onLocationError(t){let e;switch(t.code){case t.PERMISSION_DENIED:e={header:"Salli paikannus",body:"Sallithan paikannuksen selaimesi asetuksista. Sijaintiasi käytetään vain lähimpien pysäkkien löytämiseen",button:"ok"};break;case t.POSITION_UNAVAILABLE:e={header:"Lokaatiota ei saatavilla",body:"Kokeile uudestaan",button:"ok"};break;case t.TIMEOUT:e={header:"Aikakatkaisu",body:"Lokaatiota ei löytynyt",button:"ok"};break;case t.UNKNOWN_ERROR:e={header:"Tuntematon virhe",body:"Tuntematon virhe, kokeile uudestaan",button:"ok"}}this.$emit("new-message",e)},notifyIfInaccurateLocation(t){void 0!==t&&(null!==t.accuracy&&t.accuracy>70?this.$emit("new-message",{body:`Sijainti epätarkka (${Math.ceil(t.accuracy)}m)`}):this.$emit("new-message",void 0))},stopPositionWatching(){void 0!==this.watchPositionHandle&&(navigator.geolocation.clearWatch(this.watchPositionHandle),this.watchPositionHandle=void 0)}}},S=b,_=i("2877"),k=Object(_["a"])(S,r,o,!1,null,null,null),C=k.exports,x=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._t("default"),t._l(t.filteredDepartures,(function(e){return i("div",{key:e.gtfsId},[void 0!==e.stoptimesWithoutPatterns&&!0!==e.hidden?i("section",[i("Stop",{attrs:{isFavorite:!0,stop:e,favorite:t.isFavorite(e.gtfsId)},on:{"toggle-favorite":t.toggleFavorite}}),i("Departures",{attrs:{departures:e.stoptimesWithoutPatterns,isFavorite:!0,realtime:t.realtime}})],1):t._e()])})),null==t.departureData||t.departureData.length<1?i("div",{staticClass:"empty-favorite"},[i("div",[i("svg",{staticClass:"favorite-svg",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"}}),i("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})])]),i("h3",[t._v("Suosikkilista on tyhjä")]),i("div",[t._v("Lisää suosikkisi lähellä näkymässä")])]):t._e(),t.noResults(t.departureData)?i("div",{staticClass:"no-results"},[t._v("Ei tuloksia")]):t._e()],2)},F=[],N=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"departures",class:{"departures--favorite":t.isFavorite}},[t.departures.length<1?i("div",{staticClass:"no-departures"},[t._v("—")]):t._e(),t._l(t.departures,(function(e){return i("article",{key:e.trip.id,staticClass:"departure",class:{"departure--favorite":!0===e.favorite,"departure--hidden":!0===e.hidden},on:{click:function(i){return t.addLine(e)}}},[i("div",{class:{"realtime-sign":e.realtime&&t.realtime}}),i("div",{staticClass:"time"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.realtime,expression:"!realtime"}],attrs:{"data-hook":"time-schedule"}},[t._v(t._s(t.timeToString(t.toHourAndMinutes(e.scheduledDeparture))))]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.realtime,expression:"realtime"}]},[t._v("\n        "+t._s(t.toRealtime(new Date,e.scheduledDeparture,e.departureDelay,e.realtime,e.serviceDay))+"\n      ")])]),i("div",{staticClass:"line"},[t._v(t._s(e.trip.routeShortName))]),i("div",[t._v(t._s(e.headsign))]),i("div")])}))],2)},O=[],A={name:"Schedule",props:{departures:Array,isFavorite:Boolean,realtime:Boolean},methods:{addLine(t){const e=t.trip.routeShortName;let i=window.localStorage.getItem("favoriteLines");null==i&&(i="[]");let a=JSON.parse(i);a.includes(e)?a=a.filter(t=>t!==e):a.push(e),window.localStorage.setItem("favoriteLines",JSON.stringify(a)),this.$emit("departure-clicked",{routeShortName:t.trip.routeShortName,headsign:t.headsign})},findIsFavorite(t){const e=t.trip.routeShortName;let i=window.localStorage.getItem("favoriteLines");if(null==i)return!1;let a=JSON.parse(i);return a.includes(e)},dayNumber(t){return new Date(1e3*t).getDate()},toHourAndMinutes:function(t){const e=Math.floor(t/3600),i=60*e*60,a=Math.floor((t-i)/60);return{hours:e,minutes:a}},timeToString:function(t){const e=t.hours>9?`${t.hours}`:`0${t.hours}`,i=t.minutes>9?`${t.minutes}`:`0${t.minutes}`;return`${e}.${i}`},toRealtime:function(t,e,i){const a=this.getSecondsSinceMidnight(t),s=Math.round((e-a)/60);if(s>59||s<-30)return this.timeToString(this.toHourAndMinutes(e));const n=s>0?s:0;let r=s+Math.ceil(i/60);return r=r>0?r:0,r===n?n:n<r?`${n}-${r}*`:`${r}*-${n}`},getSecondsSinceMidnight:function(t){let e=new Date(t);const i=t-e.setHours(0,0,0,0);return i/1e3}}},D=A,T=(i("ab2d"),Object(_["a"])(D,N,O,!1,null,"490b350c",null)),M=T.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showPrompt()?i("section",{attrs:{id:"install-prompt"}},[i("h2",[t._v("Asenna sovellus")]),t.showInstructions?t._e():i("div",{on:{click:t.onInstructionClick}},[i("div",{staticClass:"body"},[t._v("Näet pysäkkiaikataulut ja reaaliaikaiset saapumisajat entistä nopeammin")]),i("s-button",[i("svg",{staticClass:"install-now-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}})]),i("span",{staticStyle:{color:"#fff"}},[t._v("Asenna nyt")])])],1),t.showInstructions?i("div",[i("div",{staticClass:"body--instructions"},[i("ol",[i("li",[t._v("\n          valitse\n          "),i("svg",{staticClass:"ios-share-icon",attrs:{viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid meet"}},[i("g",{attrs:{id:"iosShare"}},[i("polyline",{staticClass:"arrow",attrs:{"stroke-width":"3",points:"40,12 50,2 60,12",fill:"none"}}),i("line",{staticClass:"arrow-line",attrs:{"stroke-width":"3",x1:"50",y1:"2",x2:"50",y2:"45"}}),i("polyline",{staticClass:"rectangle",attrs:{"stroke-width":"3",points:"45,20 27,20 27,70 73,70 73,20 55,20",fill:"none"}})])]),t._v("\n          kuvake alhaalta,\n        ")]),i("li",[t._v("skrollaa alaspäin ja")]),i("li",[t._v("lisää kotivalikkoon")])])])]):t._e()]):t._e()},E=[],L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",[t._t("default")],2)},z=[],I={name:"s-button"},B=I,P=(i("1e55"),Object(_["a"])(B,L,z,!1,null,"0021ad3e",null)),j=P.exports,H={name:"Install",components:{SButton:j},props:{forceShow:Boolean},mounted:function(){},data(){return{showInstructions:!1}},methods:{showPrompt:function(){if(navigator.standalone)return firebase.analytics().setUserProperties({"standalone-app":"true"}),!1;const t=["iPhone","iPad","iPod"].includes(navigator.platform);return!0===t||!0===this.forceShow},onInstructionClick:function(){this.showInstructions=!0,window.location.href="#install-prompt"}}},R=H,V=(i("9d5d"),Object(_["a"])(R,$,E,!1,null,"30f1af50",null)),J=V.exports,W=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("header",{class:{"header--favorite":t.isFavorite}},[i("div",[i("span",{staticClass:"name"},[t._v(t._s(t.stop.name))]),i("br"),i("span",{staticClass:"secondary"},[i("span",{staticClass:"code"},[t._v(t._s(t.stop.code))]),t._v("\n      "+t._s(t.stop.desc)+"\n    ")])]),i("div",{staticClass:"distance"},[t._v(t._s(t.formatDistance(t.stop.distance)))]),i("div",{staticClass:"favorite"},[i("Star",{attrs:{selected:t.favorite},on:{toggle:t.toggleFavorite}})],1)])},q=[],U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{on:{click:function(e){return t.toggle()}}},[i("svg",{class:{"star--selected":t.selected},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("path",{directives:[{name:"show",rawName:"v-show",value:!t.selected,expression:"!selected"}],attrs:{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55l-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}}),i("path",{directives:[{name:"show",rawName:"v-show",value:t.selected,expression:"selected"}],attrs:{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}})])])},Y=[],G={name:"Star",props:{selected:Boolean},mounted:function(){},methods:{toggle:function(){this.$emit("toggle",!this.selected),firebase.analytics().logEvent("favorite-stop-added-or-removed")}}},K=G,Q=(i("6637"),Object(_["a"])(K,U,Y,!1,null,"f057403c",null)),X=Q.exports,Z={name:"Stop",props:{favorite:Boolean,isFavorite:Boolean,stop:Object},components:{Star:X},methods:{toggleFavorite:function(t){this.$emit("toggle-favorite",{stopId:this.stop.gtfsId,selected:t})},formatDistance:function(t){if(t<1e3)return`${t}m`;const e=Math.round(t/100)/10;return`${e}km`}}},tt=Z,et=(i("e7c3"),Object(_["a"])(tt,W,q,!1,null,"5362fba6",null)),it=et.exports;function at(t,e){if(void 0===e||void 0===t)return t;const i=[...t];let s;return i.forEach(t=>{s=!1,void 0!==t.stoptimesWithoutPatterns&&(t.stoptimesWithoutPatterns.forEach(t=>{e.some(e=>{return e.headsign===t.headsign&&!0===e.active&&(e.routeShortName===t.trip.routeShortName||"direction"===e.type)})?(a["a"].set(t,"hidden",!1),s=!0):a["a"].set(t,"hidden",!0)}),a["a"].set(t,"hidden",!s))}),st(i)&&i.map(t=>{a["a"].set(t,"hidden",!1),t.stoptimesWithoutPatterns.map(t=>{a["a"].set(t,"hidden",!1)})}),i}function st(t){return void 0===t||t.every(t=>{return!0===t.hidden})}var nt={name:"Favorite",components:{Departures:M,Install:J,Stop:it},props:{favoriteStops:Array,filter:Array,realtime:Boolean,departureData:Array},computed:{filteredDepartures:function(){return at(this.departureData,this.filter)}},methods:{isFavorite(t){return this.favoriteStops.includes(t)},noResults(t){return void 0!==t&&t.length>0&&t.every(t=>{return!0===t.hidden})},toggleFavorite(t){this.$emit("toggle-favorite",t)}}},rt=nt,ot=(i("46cd"),Object(_["a"])(rt,x,F,!1,null,"ac84bbf2",null)),lt=ot.exports,ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"filter-lines"},[i("Icons"),i("div",{staticClass:"filter-tag"},[i("tag-accordion",{ref:"lineAccordion",attrs:{open:t.lineAccordionOpen},on:{opened:function(e){return t.toggleLineAccordion()}}},[i("template",{slot:"header"},[i("div",{staticClass:"add-filter"},[t._v("LINJA")])]),i("template",{slot:"body"},[i("div",{staticClass:"gray-background"},[void 0===t.lineFilterValue?i("div",{staticClass:"tag-container"},t._l(t.allLineTags,(function(e){return i("div",{key:e.routeShortName+e.headsign,on:{click:function(i){return t.lineSelected(e)}}},[i("tag",{attrs:{type:e.mode}},[t._v(t._s(e.routeShortName))])],1)})),0):t._e(),void 0!==t.lineFilterValue?i("div",{staticClass:"tag-container"},[i("tag",{attrs:{tagSelected:!0,type:t.lineFilterValue.mode}},[t._v("\n              "+t._s(t.lineFilterValue.routeShortName)+"\n            ")]),t._l(t.filteredDirections(t.lineFilterValue,t.allDirectionTags),(function(e){return i("div",{key:e.routeShortName+e.headsign,on:{click:function(i){return t.addLineOrDirection(e)}}},[i("tag",[t._v(t._s(e.headsign))])],1)}))],2):t._e(),i("div",{staticClass:"tag-container",on:{click:function(e){return t.toggleLineAccordion()}}},[i("tag",{attrs:{type:"wide"}},[t._v("SULJE")])],1)])])],2),i("tag-accordion",{ref:"lineAccordion",attrs:{open:t.directionAccordionOpen},on:{opened:function(e){return t.toggleDirectionAccordion()}}},[i("template",{slot:"header"},[i("div",{staticClass:"add-filter"},[t._v("SUUNTA")])]),i("template",{slot:"body"},[i("div",{staticClass:"gray-background"},[i("div",{staticClass:"tag-container"},t._l(t.removeDirectionDuplicates(t.allDirectionTags),(function(e){return i("tag",{key:e.routeShortName+e.headsign,attrs:{type:"wide-left"},on:{click:function(i){return t.addLineOrDirection(e)}}},[i("span",{on:{click:function(i){return t.addLineOrDirection(e)}}},[t._v(t._s(e.headsign))])])})),1),i("div",{staticClass:"tag-container",on:{click:function(e){return t.toggleDirectionAccordion()}}},[i("tag",{attrs:{type:"wide"}},[t._v("SULJE")])],1)])])],2)],1),i("div",{staticClass:"tag-container all-filters",class:{"gray-background":!0===t.editingFilters}},[t._l(t.hideEmptyFilters(t.allFilters,t.allDirectionTags),(function(e){return i("div",{key:e.routeShortName+e.headsign,on:{click:function(i){return t.toggleFilter(e)}}},[i("tag",{attrs:{type:e.mode,tagSelected:!0===e.active,tagRemovable:!0===t.editingFilters}},[t._v("\n        "+t._s(e.routeShortName)+"\n        "+t._s(e.headsign)+"\n      ")])],1)})),i("div",{staticClass:"tag-container tag-container--all-and-edit"},[t.allFilters.length>0&&!1===t.editingFilters?i("div",{on:{click:function(e){return t.showAll()}}},[i("tag",{attrs:{tagSelected:!t.hasActiveFilters()}},[t._v("Näytä kaikki")])],1):t._e(),t.allFilters.length>0&&!1===t.editingFilters?i("div",{attrs:{s:""},on:{click:function(e){return t.removeFilters()}}},[i("tag",[t._v("Muokkaa")])],1):t._e()]),!0===t.editingFilters?i("div",{staticClass:"wide",on:{click:function(e){return t.reset()}}},[i("tag",{attrs:{type:"wide"}},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"}})]),t._v("\n        VALMIS\n      ")])],1):t._e()],2)],1)},dt=[],ut=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{staticStyle:{position:"absolute",width:"0",height:"0"},attrs:{"aria-hidden":"true",width:"0",height:"0",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("defs",[i("symbol",{attrs:{id:"icon-subway",viewBox:"0 0 1024 1024"}},[i("path",{staticClass:"subway",attrs:{d:"M871.036 993.287H154.225c-67.864 0-122.883-55.015-122.883-122.883V153.593c0-67.864 55.015-122.883 122.883-122.883h716.811c67.864 0 122.883 55.015 122.883 122.883v716.811c0 67.868-55.018 122.883-122.883 122.883z"}}),i("path",{staticClass:"white",attrs:{d:"M732.237 401.243v-21.037c0-1.252 2.505-2.473 5.009-2.473v504.921h156.056V141.347h-230.28L518.296 647.521l-2.504 34.655h-3.788l-3.788-34.655-144.692-506.174H131.96v741.307h158.56V377.733c1.253 0 3.789 1.22 3.789 2.473v21.037l140.936 481.411h154.773l142.22-481.411z"}})]),i("symbol",{attrs:{id:"icon-bus",viewBox:"0 0 1024 1024"}},[i("path",{staticClass:"white",attrs:{d:"M874.388 993.287h-716.811c-67.864 0-122.883-55.015-122.883-122.883v-716.811c0-67.864 55.015-122.883 122.883-122.883h716.811c67.864 0 122.883 55.015 122.883 122.883v716.811c0 67.868-55.018 122.883-122.883 122.883z"}}),i("path",{staticClass:"bus",attrs:{d:"M0.033 126.799c0-69.114 57.594-126.709 126.709-126.709h767.931c71.676 0 129.27 57.594 129.27 126.709v767.931c0 71.672-57.594 129.27-129.27 129.27h-767.928c-69.114 0-126.709-57.594-126.709-129.27v-767.931zM513.268 110.16c-106.229 0-198.384 5.119-299.491 19.197-30.717 3.84-48.635 21.758-48.635 48.635v598.985c0 19.197 14.078 31.996 26.877 35.836l38.397 6.398v80.631c0 8.959 7.68 15.36 17.918 15.36h61.434c7.68 0 15.357-6.398 15.357-15.36v-71.672c49.914 6.398 117.75 8.959 185.585 8.959 69.114 0 139.508-2.558 188.146-8.959v71.672c0 8.959 8.959 15.36 16.636 15.36h61.434c10.238 0 17.918-6.398 17.918-15.36v-80.631l38.397-6.398c14.078-3.84 26.877-15.357 26.877-35.836v-598.982c0-26.877-17.918-44.795-48.635-48.635-102.393-12.799-195.823-19.2-298.216-19.2zM778.205 620.834c-72.951 12.799-168.946 25.598-262.376 25.598-98.553 0-191.983-11.517-266.216-28.156-20.476-3.84-28.156-11.52-28.156-28.156v-373.731c0-16.636 7.68-28.156 28.156-28.156l528.592 2.558c20.479 0 26.877 11.52 26.877 28.159v373.728c0 16.639-6.398 25.598-26.877 28.156zM241.933 723.227c1.279-16.636 16.636-31.996 34.557-31.996 17.918 0 33.275 15.357 33.275 31.996 0 19.197-15.357 34.557-33.275 34.557-19.197-1.279-34.557-16.639-34.557-34.557zM710.373 723.227c1.279-16.636 16.639-31.996 33.275-31.996 17.918 0 33.278 15.357 33.278 31.996 0 19.197-15.357 34.557-33.278 34.557-17.918-1.279-33.275-16.639-33.275-34.557z"}})]),i("symbol",{attrs:{id:"icon-rail",viewBox:"0 0 1024 1024"}},[i("path",{staticClass:"white",attrs:{d:"M870.407 993.287h-716.811c-67.864 0-122.883-55.015-122.883-122.883v-716.811c0-67.864 55.015-122.883 122.883-122.883h716.811c67.864 0 122.883 55.015 122.883 122.883v716.811c0 67.868-55.018 122.883-122.883 122.883z"}}),i("path",{staticClass:"rail",attrs:{d:"M0.033 126.799c0-69.114 57.594-126.709 126.709-126.709h767.931c71.676 0 129.27 57.594 129.27 126.709v767.931c0 71.672-57.594 129.27-129.27 129.27h-767.931c-69.114 0-126.709-57.594-126.709-129.27v-767.931zM785.886 130.639c-28.156-25.598-149.749-55.036-273.896-55.036-120.311 0-244.458 29.438-271.335 55.036-19.197 16.636-38.397 55.033-61.434 103.672-19.197 42.234-34.557 81.913-34.557 104.95v369.888c0 29.438 10.238 42.237 49.918 72.954 29.435 23.037 42.234 33.275 87.032 33.275h84.471v55.036h295.654v-55.036h83.192c44.795 0 57.594-10.238 85.754-33.275 39.676-31.996 48.635-43.516 48.635-72.954v-369.888c0-23.037-15.357-62.713-33.275-104.95-23.044-48.639-40.962-87.032-60.159-103.672zM751.328 908.812v-53.754h-47.356v53.754h-381.404v-53.754h-48.639v53.754h-58.873c-14.078 0-25.598 11.517-25.598 24.316 0 14.078 11.52 25.598 25.598 25.598h596.428c14.078 0 24.316-11.52 24.316-25.598 0-12.799-10.238-24.316-24.316-24.316h-60.155zM724.451 582.44c-3.836 21.758-25.595 38.397-47.356 38.397h-327.654c-21.758 0-43.516-16.639-47.353-38.397l-60.155-254.699c-3.84-21.758 10.238-38.397 31.996-38.397h477.399c21.758 0 37.115 16.639 31.996 38.397l-58.873 254.699zM706.533 175.434v21.758c0 16.639-12.799 30.717-29.438 30.717h-327.654c-16.636 0-30.717-14.078-30.717-30.717v-21.758h387.809zM318.727 715.546c0-17.918 12.799-31.996 30.717-31.996s33.278 14.078 33.278 31.996-15.357 30.717-33.278 30.717c-17.918 0-30.717-12.799-30.717-30.717zM645.099 711.706c0-17.918 14.078-31.996 31.996-31.996s31.996 14.078 31.996 31.996-14.078 30.717-31.996 30.717c-17.918 0-31.996-12.799-31.996-30.717z"}})]),i("symbol",{attrs:{id:"icon-tram",viewBox:"0 0 1024 1024"}},[i("path",{staticClass:"white",attrs:{d:"M870.393 993.287h-716.811c-67.864 0-122.883-55.015-122.883-122.883v-716.811c0-67.864 55.015-122.883 122.883-122.883h716.811c67.864 0 122.883 55.015 122.883 122.883v716.811c0 67.868-55.015 122.883-122.883 122.883z"}}),i("path",{staticClass:"tram",attrs:{d:"M0.033 126.799c0-69.114 57.594-126.709 126.709-126.709h767.931c71.676 0 129.27 57.594 129.27 126.709v767.931c0 71.672-57.594 129.27-129.27 129.27h-767.931c-69.114 0-126.709-57.594-126.709-129.27v-767.931zM715.492 218.95c-6.398-15.36-15.357-23.037-30.717-26.877-55.033-14.078-94.713-19.197-145.909-20.476v-44.799h94.713c12.799 0 23.037-11.52 23.037-24.319 0-15.357-10.238-26.877-23.037-26.877h-240.618c-15.357 0-26.877 11.517-26.877 26.877 0 12.799 11.52 24.319 26.877 24.319h93.43v44.795c-52.475 1.279-94.713 6.398-145.909 20.476-17.918 5.119-26.877 11.517-34.557 26.877l-21.758 52.475c-6.398 15.357-6.398 37.115-6.398 53.754v460.76c0 23.037 15.357 37.115 38.397 40.955 69.114 14.078 129.27 19.197 195.823 19.197 63.995 0 125.43-5.119 197.102-19.197 21.758-3.84 38.397-17.918 38.397-40.955v-460.753c0-16.639-3.84-38.397-10.238-53.754l-21.758-52.479zM651.497 908.812v-38.397l-47.356 6.398v31.996h-183.024v-31.996l-47.356-6.398v38.397h-38.397c-14.078 0-23.037 11.517-23.037 23.037 0 16.639 8.959 26.877 23.037 26.877h354.527c11.52 0 24.319-10.238 24.319-26.877 0-11.517-12.799-23.037-24.319-23.037h-38.394zM323.846 711.706c0-17.918 12.799-31.996 29.435-31.996 17.918 0 30.717 14.078 30.717 31.996 0 16.639-12.799 28.156-30.717 28.156-16.636 0.004-29.435-11.517-29.435-28.156zM325.125 314.942h372.449v311.011c-48.635 14.078-117.75 23.037-185.585 23.037-66.553 0-135.668-10.238-186.864-23.037v-311.011zM646.378 711.706c0-17.918 11.52-31.996 28.156-31.996 17.918 0 31.996 14.078 31.996 31.996 0 16.639-14.078 28.156-31.996 28.156-16.636 0.004-28.156-11.517-28.156-28.156z"}})])])])},ht=[],vt={name:"Icons"},ft=vt,pt=(i("2d11"),Object(_["a"])(ft,ut,ht,!1,null,"41f0b941",null)),gt=pt.exports,mt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"section container"},[i("article",{staticClass:"message",class:t.accordionClasses},[i("div",{staticClass:"message-header message-header--underline",on:{click:function(e){return t.$emit("opened")}}},[t._t("header"),i("svg",{staticClass:"handle",class:{"handle--open":t.open},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"6",height:"6",viewBox:"0 0 292.4 292.4"}},[i("path",{attrs:{fill:"#000",d:"M287 69.4a17.6 17.6 0 0 0-13-5.4H18.4c-5 0-9.3 1.8-12.9 5.4A17.6 17.6 0 0 0 0 82.2c0 5 1.8 9.3 5.4 12.9l128 127.9c3.6 3.6 7.8 5.4 12.8 5.4s9.2-1.8 12.8-5.4L287 95c3.5-3.5 5.4-7.8 5.4-12.8 0-5-1.9-9.2-5.5-12.8z"}})])],2),i("div",{staticClass:"message-body"},[i("div",{staticClass:"message-content"},[t._t("body")],2)])])])},wt=[],yt={name:"tag-accordion",props:{open:Boolean},mounted(){this.open=!1},computed:{accordionClasses:function(){return{"is-closed":!this.open,"is-primary":this.open}}}},bt=yt,St=(i("fda8"),Object(_["a"])(bt,mt,wt,!1,null,"9f66c692",null)),_t=St.exports,kt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a",{staticClass:"tag",class:{"tag--selected":t.tagSelected,"tag--removable":!0===t.tagRemovable,"tag--filter":"filter"===t.type,"tag--right":"edit"===t.type,"tag--wide":"wide"===t.type,"tag--wide-left":"wide-left"===t.type},attrs:{href:"#"}},[void 0!==t.type?i("svg",{staticClass:"transport-type",attrs:{viewBox:"0 0 1024 1024",width:"18",height:"18"}},["BUS"===t.type?i("use",{attrs:{"xlink:href":"#icon-bus"}}):t._e(),"RAIL"===t.type?i("use",{attrs:{"xlink:href":"#icon-rail"}}):t._e(),"SUBWAY"===t.type?i("use",{attrs:{"xlink:href":"#icon-subway"}}):t._e(),"TRAM"===t.type?i("use",{attrs:{"xlink:href":"#icon-tram"}}):t._e()]):t._e(),t._t("default"),!0===t.tagRemovable?i("span",[i("svg",{staticClass:"remove-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}}),i("path",{attrs:{fill:"none",d:"M0 0h24v24H0z"}})])]):t._e(),"edit"===t.type?i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}}),i("path",{attrs:{fill:"none",d:"M0 0h24v24H0z"}})]):t._e()],2)},Ct=[],xt={name:"tag",props:{type:String,tagRemovable:Boolean,tagSelected:Boolean,textValue:String}},Ft=xt,Nt=(i("ee08"),Object(_["a"])(Ft,kt,Ct,!1,null,"33e31768",null)),Ot=Nt.exports;const At=(t,e)=>{return t.routeShortName<e.routeShortName?-1:1},Dt=(t,e)=>{return t.headsign<e.headsign?-1:1};function Tt(t){let e=[];return t.forEach(t=>{t.stoptimesWithoutPatterns.forEach(i=>{e.some(t=>{return t.routeShortName===i.trip.routeShortName})||e.push({routeShortName:i.trip.routeShortName,lat:t.lat,lon:t.lon,mode:i.trip.route.mode})})}),e.sort(At)}function Mt(t){let e=[];return t.forEach(t=>{t.stoptimesWithoutPatterns.forEach(i=>{e.some(t=>{return i.headsign===t.headsign&&i.trip.routeShortName===t.routeShortName})||e.push({headsign:i.headsign,routeShortName:i.trip.routeShortName,lat:t.lat,lon:t.lon})})}),e.sort(Dt)}var $t={name:"filter-lines",components:{Icons:gt,Tag:Ot,TagAccordion:_t},props:{favorite:Boolean,lat:Number,lon:Number,departureData:Array},computed:{allLineTags:function(){if(void 0!==this.departureData)return Tt(this.departureData)},allDirectionTags:function(){if(void 0!==this.departureData)return Mt(this.departureData)}},data(){return{directionAccordionOpen:!1,lineAccordionOpen:!1,lineFilterValue:void 0,allFilters:[],sortByRouteShortName:(t,e)=>{return t.routeShortName!==e.routeShortName?t.routeShortName<e.routeShortName?-1:1:t.headsign<e.headsign?-1:1},editingFilters:!1}},mounted(){this.allFilters=this.restoreFilters(),this.notify()},methods:{addFilter(t,e){const i=[...this.allFilters],a=void 0===t?{type:"direction",active:!0,headsign:e.headsign,lat:this.lat,lon:this.lon}:{type:"line",active:!0,headsign:e.headsign,lat:t.lat,lon:t.lon,routeShortName:t.routeShortName,mode:t.mode};return i.push(a),i.sort(this.sortByRouteShortName)},hasActiveFilters(){return this.allFilters.some(t=>{return!0===t.active})},hideEmptyFilters(t,e){const i=2e3;return this.editingFilters||void 0===e?t:t.filter(t=>{return e.some(e=>{const a=d(l(t.lat,t.lon,this.lat,this.lon));return"direction"===t.type?t.headsign===e.headsign&&a<i:t.routeShortName===e.routeShortName&&t.headsign===e.headsign&&a<i})})},toggleLineAccordion(){!1===this.lineAccordionOpen?(this.lineAccordionOpen=!0,this.directionAccordionOpen=!1,this.editingFilters=!1):this.reset()},toggleDirectionAccordion(){!1===this.directionAccordionOpen?(this.directionAccordionOpen=!0,this.lineAccordionOpen=!1,this.editingFilters=!1):this.reset()},addLineOrDirection(t){this.lineAccordionOpen=!1,this.allFilters=this.addFilter(this.lineFilterValue,t),this.storeFiltersAndNotify(),this.reset()},removeDirectionDuplicates(t){if(void 0===t)return;let e=[];return t.forEach(t=>{e.some(e=>{return e.headsign===t.headsign})||e.push({headsign:t.headsign})}),e},filteredDirections(t,e){let i=[];if(!(void 0===t||void 0===e||e.length<1))return e.forEach(e=>{t.routeShortName===e.routeShortName&&i.push({headsign:e.headsign})}),i},lineSelected:function(t){this.lineFilterValue=t},removeFilters(){this.reset(),this.editingFilters=!0},removeFilter(t){const e=[...this.allFilters];return e.filter(e=>{return e.headsign!==t.headsign||e.routeShortName!==t.routeShortName})},reset(){this.lineFilterValue=void 0,this.editingFilters=!1,this.lineAccordionOpen=!1,this.directionAccordionOpen=!1},showAll(){this.reset(),this.allFilters=this.allFilters.map(t=>{let e={...t};return e.active=!1,e}),this.storeFiltersAndNotify()},toggleFilter(t){if(!0===this.editingFilters)return this.allFilters=this.removeFilter(t),this.allFilters.length<1&&(this.editingFilters=!1),void this.storeFiltersAndNotify();t.active=!t.active,this.storeFiltersAndNotify()},restoreFilters(){const t=!0===this.favorite?"favoriteFilters":"nearestFilters";let e=window.localStorage.getItem(t);return null==e&&(e="[]"),JSON.parse(e)},storeFiltersAndNotify(){const t=!0===this.favorite?"favoriteFilters":"nearestFilters";window.localStorage.setItem(t,JSON.stringify(this.allFilters)),this.notify()},notify(){this.$emit("new-filter-value",this.hideEmptyFilters(this.allFilters,this.allDirectionTags))}}},Et=$t,Lt=(i("9408"),Object(_["a"])(Et,ct,dt,!1,null,"8c3cb07e",null)),zt=Lt.exports,It=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bottom-sheet"},[i("div",{staticClass:"above-notification",class:{"above-notification--hidden":void 0===t.statusText}},[t._v(t._s(t.statusText))]),t._t("default"),i("nav",[i("div",{staticClass:"tab"},[i("TimeSwitch",{on:{"time-switch-clicked":function(e){return t.$emit("time-switch-clicked")}}}),i("Clock")],1),i("div",{staticClass:"tab nearby",attrs:{selected:"nearby"===t.selectedTab},on:{click:t.clickNearby}},[i("svg",{staticClass:"nearby-svg",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}})]),i("div",[t._v("lähellä")])]),i("div",{staticClass:"tab favorite",attrs:{selected:"favorite"===t.selectedTab},on:{click:t.clickFavorite}},[i("svg",{staticClass:"favorite-svg",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}}),i("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}})]),i("div",[t._v("suosikit")])])])],2)},Bt=[],Pt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._v(t._s(t.time))])},jt=[],Ht={name:"Clock",props:{stop:Object},data(){return{time:""}},mounted:function(){this.startClock()},methods:{startClock:function(){setInterval(()=>{const t=new Date;this.time=t.toLocaleTimeString("fi-FI")},1e3)}}},Rt=Ht,Vt=Object(_["a"])(Rt,Pt,jt,!1,null,"11c04b07",null),Jt=Vt.exports,Wt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"onoffswitch"},[i("input",{staticClass:"onoffswitch-checkbox",attrs:{type:"checkbox",name:"onoffswitch",id:"myonoffswitch",checked:""},on:{change:function(e){return t.checkboxChanged()}}}),t._m(0)])},qt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("label",{staticClass:"onoffswitch-label",attrs:{for:"myonoffswitch"}},[i("span",{staticClass:"onoffswitch-inner"}),i("span",{staticClass:"onoffswitch-switch"})])}],Ut={name:"TimeSwitch",methods:{checkboxChanged(){this.$emit("time-switch-clicked")}}},Yt=Ut,Gt=(i("8a45"),Object(_["a"])(Yt,Wt,qt,!1,null,"cceb3be4",null)),Kt=Gt.exports,Qt={name:"Navigation",components:{Clock:Jt,TimeSwitch:Kt},data(){return{TAB:{NEARBY:"nearby",FAVORITE:"favorite",STORAGE_NAME:"selectedTab"},selectedTab:"nearby",statusText:void 0}},mounted:function(){const t=this.getSelectedTab();t===this.TAB.FAVORITE&&this.clickFavorite()},methods:{clickNearby:function(){this.$emit(this.TAB.NEARBY),this.setSelectedTab(this.TAB.NEARBY),firebase.analytics().logEvent("navigation-nearby-click")},clickFavorite:function(){this.$emit(this.TAB.FAVORITE),this.setSelectedTab(this.TAB.FAVORITE),firebase.analytics().logEvent("navigation-favorite-click")},dataUpdated:function(t){this.statusText=t,setTimeout(()=>{this.statusText=void 0},3e3)},getSelectedTab:function(){return window.localStorage.getItem(this.TAB.STORAGE_NAME)},setSelectedTab:function(t){this.selectedTab=t||"nearby",window.localStorage.setItem(this.TAB.STORAGE_NAME,t)}}},Xt=Qt,Zt=(i("f264"),Object(_["a"])(Xt,It,Bt,!1,null,"c694a0cc",null)),te=Zt.exports,ee=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._t("default"),t._l(t.filteredDepartures,(function(e){return i("div",{key:e.gtfsId},[void 0!==e.stoptimesWithoutPatterns&&!0!==e.hidden?i("section",{class:{"stop--hidden":!0===e.hidden}},[i("Stop",{attrs:{stop:e,favorite:t.isFavorite(e.gtfsId)},on:{"toggle-favorite":t.toggleFavorite}}),i("Departures",{attrs:{departures:e.stoptimesWithoutPatterns,realtime:t.realtime},on:{"departure-clicked":t.departureClicked}})],1):t._e()])})),void 0===t.departureData||t.departureData.length<1?i("div",[i("loader-spinner",{staticClass:"spinner"})],1):t._e(),t.noResults(t.departureData)?i("div",{staticClass:"no-results"},[t._v("Ei tuloksia")]):t._e()],2)},ie=[],ae=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loader"},[i("svg",{staticClass:"circular"},[i("circle",{staticClass:"path",attrs:{cx:"50",cy:"50",r:"20",fill:"none","stroke-width":"4","stroke-miterlimit":"10"}})])])},se=[],ne={name:"loader-spinner"},re=ne,oe=(i("db8c"),Object(_["a"])(re,ae,se,!1,null,"a21fee02",null)),le=oe.exports,ce={name:"Nearest",props:{favoriteStops:Array,filter:Array,realtime:Boolean,departureData:Array},computed:{filteredDepartures:function(){return at(this.departureData,this.filter)}},components:{Departures:M,LoaderSpinner:le,Stop:it},methods:{departureClicked(t){this.$emit("departure-clicked",t)},isFavorite(t){return this.favoriteStops.includes(t)},noResults(t){return void 0!==t&&t.length>0&&t.every(t=>{return!0===t.hidden})},toggleFavorite:function(t){this.$emit("toggle-favorite",t)}}},de=ce,ue=(i("6d1f"),Object(_["a"])(de,ee,ie,!1,null,"ed28f66c",null)),he=ue.exports,ve=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",[i("div",{staticClass:"minutes"},[t._v("2-9*")]),i("div",[i("svg",{staticClass:"transport-type",attrs:{viewBox:"0 0 1024 1024",width:"16",height:"16"}},[i("use",{attrs:{"xlink:href":"#icon-bus"}})]),i("span",{staticClass:"line"},[t._v(t._s(t.routeShortName))]),i("div",{staticClass:"direction"},[t._v(t._s(t.headsign))])]),i("div",[i("svg",{staticClass:"remove-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zm2.46-7.12l1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14l-2.13-2.12zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}}),i("path",{attrs:{fill:"none",d:"M0 0h24v24H0z"}})])])])},fe=[],pe={name:"NextDeparture",props:{headsign:String,routeShortName:String}},ge=pe,me=(i("e08b"),Object(_["a"])(ge,ve,fe,!1,null,"3b960f37",null)),we=me.exports,ye=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"notification",attrs:{role:"dialog","aria-modal":"true"}},[void 0!==t.texts.header?i("h2",[i("div",[i("svg",{staticClass:"icon",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24"}},[i("path",{attrs:{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"}})])]),t._v("\n    "+t._s(t.texts.header)+"\n  ")]):t._e(),i("main",[t._v(t._s(t.texts.body))]),void 0!==t.texts.button?i("footer",{on:{click:function(e){return t.$emit("notification-button-clicked")}}},[i("s-button",[t._v(t._s(t.texts.button))])],1):t._e()])},be=[],Se={name:"Notification",props:{texts:Object},components:{SButton:j},data:function(){return{showUpdatedText:!1}}},_e=Se,ke=(i("8cfd"),Object(_["a"])(_e,ye,be,!1,null,"d5385876",null)),Ce=ke.exports,xe=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("s-accordion",{staticClass:"accordion",attrs:{noHandle:!0}},[i("template",{slot:"header"},[i("a",[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"24",height:"24",viewBox:"0 0 24 24"}},[i("defs",[i("path",{attrs:{id:"a",d:"M24 24H0V0h24v24z"}})]),i("clipPath",{attrs:{id:"b"}},[i("use",{attrs:{"xlink:href":"#a",overflow:"visible"}})]),i("path",{attrs:{"clip-path":"url(#b)",d:"M2.5 4v3h5v12h3V7h5V4h-13zm19 5h-9v3h3v7h3v-7h3V9z"}})])])]),i("template",{slot:"body"},[i("div",{staticClass:"options"},[i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,90)}}},[t._v("90%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,95)}}},[t._v("95%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,100)}}},[t._v("100%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,105)}}},[t._v("105%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,110)}}},[t._v("110%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,115)}}},[t._v("115%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,120)}}},[t._v("120%")]),i("div",{staticClass:"option",on:{click:function(e){return t.resize(e,125)}}},[t._v("125%")])])])],2)},Fe=[],Ne=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"section container"},[i("article",{staticClass:"message",class:t.accordionClasses},[i("div",{staticClass:"message-header",class:{"message-header--underline":!0!==t.noHandle},on:{click:t.toggleAccordion}},[t._t("header"),!0!==t.noHandle?i("svg",{class:{"svg--open":t.isOpen},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"6",height:"6",viewBox:"0 0 292.4 292.4"}},[i("path",{attrs:{fill:"#000",d:"M287 69.4a17.6 17.6 0 0 0-13-5.4H18.4c-5 0-9.3 1.8-12.9 5.4A17.6 17.6 0 0 0 0 82.2c0 5 1.8 9.3 5.4 12.9l128 127.9c3.6 3.6 7.8 5.4 12.8 5.4s9.2-1.8 12.8-5.4L287 95c3.5-3.5 5.4-7.8 5.4-12.8 0-5-1.9-9.2-5.5-12.8z"}})]):t._e()],2),i("div",{staticClass:"message-body"},[i("div",{staticClass:"message-content"},[t._t("body")],2)])])])},Oe=[],Ae={name:"s-accordion",props:{noHandle:Boolean},data:function(){return{isOpen:!1}},methods:{close:function(){this.isOpen=!1},open:function(){this.isOpen=!0},toggleAccordion:function(){this.isOpen=!this.isOpen}},computed:{accordionClasses:function(){return{"is-closed":!this.isOpen,"is-primary":this.isOpen}}}},De=Ae,Te=(i("2600"),Object(_["a"])(De,Ne,Oe,!1,null,"f325ff02",null)),Me=Te.exports,$e={name:"Text-resizer",components:{SAccordion:Me},data:function(){return{fontSize:100}},methods:{resize:function(t,e){this.fontSize=e,document.querySelector("html").style.fontSize=`${this.fontSize}%`}}},Ee=$e,Le=(i("bf30"),Object(_["a"])(Ee,xe,Fe,!1,null,"678cc5c4",null)),ze=Le.exports,Ie={name:"app",components:{Data:C,Favorite:lt,FilterLines:zt,Install:J,Navigation:te,Nearest:he,NextDeparture:we,Notification:Ce,TextResizer:ze},data:function(){return{departureData:[],favoriteFilter:void 0,favoriteStops:[],favoriteTab:!1,message:void 0,nearestFilter:[],previousScrollPosition:0,realtime:!0,selectedDeparture:void 0}},mounted:function(){null===window.localStorage.getItem("locationAllowed")?(this.setAllowLocationNotification(),this.$refs.data.startPollingDefault()):this.$refs.data.startPolling();const t=window.localStorage.getItem("favoriteStops");null===t?window.localStorage.setItem("favoriteStops",JSON.stringify([])):this.favoriteStops=JSON.parse(t),document.querySelector(".swipe").addEventListener("touchend",this.swipeListener)},methods:{addFavorite(t){this.favoriteStops.push(t),window.localStorage.setItem("favoriteStops",JSON.stringify(this.favoriteStops))},favoriteClicked(){this.$refs.swipe.scrollTo(this.$refs.swipe.scrollWidth,0),document.querySelector("html").scrollTop=0,this.favoriteTab=!0,this.$refs.data.fetch()},departureClicked(t){this.selectedDeparture=t},departureDataReceived(t){this.updateStatus("päivitetty"),this.departureData=t},filterFavorite(t){this.favoriteFilter=t},filterNearest(t){this.nearestFilter=t},nearbyClicked(){this.$refs.swipe.scrollTo(0,0),document.querySelector("html").scrollTop=0,this.favoriteTab=!1,this.$refs.data.fetch()},onLocationFound(){this.message=void 0,window.localStorage.setItem("locationAllowed")},onNewMessage(t){this.message=t},allowLocationClicked(){this.$refs.data.startPolling()},removeFavorite(t){this.favoriteStops=this.favoriteStops.filter(e=>{return e!==t}),window.localStorage.setItem("favoriteStops",JSON.stringify(this.favoriteStops))},scrollEnded(){return new Promise(t=>{let e=-99;const i=setInterval(()=>{let a=document.querySelector(".swipe").scrollLeft;e===a&&(clearInterval(i),t()),e=a},10)})},setAllowLocationNotification(){this.message={header:"Tarvitsemme sijaintisi",body:"Jotta voimme näyttää lähimmät pysäkit. Sijaintiasi ei tallenneta mihinkään",button:"salli sijainti"}},showRealtime(){this.realtime=!this.realtime},swipeListener(){setTimeout(async()=>{let t=document.querySelector(".swipe").scrollLeft;t<200&&!0===this.favoriteTab?(await this.scrollEnded(),this.nearbyClicked(),this.$refs.navigation.setSelectedTab("nearby")):t>=200&&!1===this.favoriteTab&&(await this.scrollEnded(),this.favoriteClicked(),this.$refs.navigation.setSelectedTab("favorite"))},500)},toggleFavorite(t){!0===t.selected?this.addFavorite(t.stopId):this.removeFavorite(t.stopId),this.$refs.data.fetch()},updateStatus(t){this.$refs.navigation.dataUpdated(t)}}},Be=Ie,Pe=(i("cab3"),Object(_["a"])(Be,s,n,!1,null,"9d04b356",null)),je=Pe.exports,He=i("9483");Object(He["a"])("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}}),a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(je)}}).$mount("#app")},"63ae":function(t,e,i){},"64ec":function(t,e,i){},6637:function(t,e,i){"use strict";var a=i("64ec"),s=i.n(a);s.a},"6cae":function(t,e,i){},"6d1f":function(t,e,i){"use strict";var a=i("51ad"),s=i.n(a);s.a},"764e":function(t,e,i){},"79d0":function(t,e,i){},"7f50":function(t,e,i){},"8a45":function(t,e,i){"use strict";var a=i("d372"),s=i.n(a);s.a},"8cfd":function(t,e,i){"use strict";var a=i("d1fc"),s=i.n(a);s.a},9408:function(t,e,i){"use strict";var a=i("ef45"),s=i.n(a);s.a},"9d5d":function(t,e,i){"use strict";var a=i("e7c5"),s=i.n(a);s.a},"9d5f":function(t,e,i){},"9fe0":function(t,e,i){},ab2d:function(t,e,i){"use strict";var a=i("1dda"),s=i.n(a);s.a},bf30:function(t,e,i){"use strict";var a=i("3a40"),s=i.n(a);s.a},c023:function(t,e,i){},cab3:function(t,e,i){"use strict";var a=i("17dd"),s=i.n(a);s.a},d1fc:function(t,e,i){},d372:function(t,e,i){},d751:function(t,e,i){},db8c:function(t,e,i){"use strict";var a=i("c023"),s=i.n(a);s.a},e08b:function(t,e,i){"use strict";var a=i("d751"),s=i.n(a);s.a},e7c3:function(t,e,i){"use strict";var a=i("9fe0"),s=i.n(a);s.a},e7c5:function(t,e,i){},ee08:function(t,e,i){"use strict";var a=i("6cae"),s=i.n(a);s.a},ef45:function(t,e,i){},f264:function(t,e,i){"use strict";var a=i("9d5f"),s=i.n(a);s.a},fda8:function(t,e,i){"use strict";var a=i("63ae"),s=i.n(a);s.a}});
//# sourceMappingURL=app.99709eb9.js.map